<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="parsimony returns the parsimony score of a tree using either the
sankoff or the fitch algorithm. optim.parsimony tries to find the
maximum parsimony tree using either Nearest Neighbor Interchange (NNI)
rearrangements or sub tree pruning and regrafting (SPR). pratchet
implements the parsimony ratchet (Nixon, 1999) and is the preferred way to
search for the best tree.  random.addition can be used to produce
starting trees."><title>Parsimony tree. — acctran • phangorn</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parsimony tree. — acctran"><meta property="og:description" content="parsimony returns the parsimony score of a tree using either the
sankoff or the fitch algorithm. optim.parsimony tries to find the
maximum parsimony tree using either Nearest Neighbor Interchange (NNI)
rearrangements or sub tree pruning and regrafting (SPR). pratchet
implements the parsimony ratchet (Nixon, 1999) and is the preferred way to
search for the best tree.  random.addition can be used to produce
starting trees."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">phangorn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/AdvancedFeatures.html">Advanced features</a>
    <a class="dropdown-item" href="../articles/Ancestral.html">Ancestral Sequence Reconstruction</a>
    <a class="dropdown-item" href="../articles/IntertwiningTreesAndNetworks.html">Intertwining phylogenetic trees and networks: R Example Script</a>
    <a class="dropdown-item" href="../articles/Networx.html">Splits and Networx</a>
    <a class="dropdown-item" href="../articles/Trees.html">Estimating phylogenetic trees with phangorn</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/KlausVigo/phangorn/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Parsimony tree.</h1>
      <small class="dont-index">Source: <a href="https://github.com/KlausVigo/phangorn/blob/HEAD/R/ancestral_pml.R" class="external-link"><code>R/ancestral_pml.R</code></a>, <a href="https://github.com/KlausVigo/phangorn/blob/HEAD/R/fitch64.R" class="external-link"><code>R/fitch64.R</code></a>, <a href="https://github.com/KlausVigo/phangorn/blob/HEAD/R/parsimony.R" class="external-link"><code>R/parsimony.R</code></a>, and 1 more</small>
      <div class="d-none name"><code>parsimony.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>parsimony</code> returns the parsimony score of a tree using either the
sankoff or the fitch algorithm. <code>optim.parsimony</code> tries to find the
maximum parsimony tree using either Nearest Neighbor Interchange (NNI)
rearrangements or sub tree pruning and regrafting (SPR). <code>pratchet</code>
implements the parsimony ratchet (Nixon, 1999) and is the preferred way to
search for the best tree.  <code>random.addition</code> can be used to produce
starting trees.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">acctran</span><span class="op">(</span><span class="va">tree</span>, <span class="va">data</span><span class="op">)</span>

<span class="fu">fitch</span><span class="op">(</span><span class="va">tree</span>, <span class="va">data</span>, site <span class="op">=</span> <span class="st">"pscore"</span><span class="op">)</span>

<span class="fu">random.addition</span><span class="op">(</span><span class="va">data</span>, tree <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="st">"fitch"</span><span class="op">)</span>

<span class="fu">parsimony</span><span class="op">(</span><span class="va">tree</span>, <span class="va">data</span>, method <span class="op">=</span> <span class="st">"fitch"</span>, cost <span class="op">=</span> <span class="cn">NULL</span>, site <span class="op">=</span> <span class="st">"pscore"</span><span class="op">)</span>

<span class="fu">optim.parsimony</span><span class="op">(</span><span class="va">tree</span>, <span class="va">data</span>, method <span class="op">=</span> <span class="st">"fitch"</span>, cost <span class="op">=</span> <span class="cn">NULL</span>, trace <span class="op">=</span> <span class="fl">1</span>,
  rearrangements <span class="op">=</span> <span class="st">"SPR"</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">pratchet</span><span class="op">(</span><span class="va">data</span>, start <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="st">"fitch"</span>, maxit <span class="op">=</span> <span class="fl">1000</span>,
  minit <span class="op">=</span> <span class="fl">10</span>, k <span class="op">=</span> <span class="fl">10</span>, trace <span class="op">=</span> <span class="fl">1</span>, all <span class="op">=</span> <span class="cn">FALSE</span>, rearrangements <span class="op">=</span> <span class="st">"SPR"</span>,
  perturbation <span class="op">=</span> <span class="st">"ratchet"</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">sankoff</span><span class="op">(</span><span class="va">tree</span>, <span class="va">data</span>, cost <span class="op">=</span> <span class="cn">NULL</span>, site <span class="op">=</span> <span class="st">"pscore"</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tree</dt>
<dd><p>tree to start the nni search from.</p></dd>


<dt>data</dt>
<dd><p>A object of class phyDat containing sequences.</p></dd>


<dt>site</dt>
<dd><p>return either 'pscore' or 'site' wise parsimony scores.</p></dd>


<dt>method</dt>
<dd><p>one of 'fitch' or 'sankoff'.</p></dd>


<dt>cost</dt>
<dd><p>A cost matrix for the transitions between two states.</p></dd>


<dt>trace</dt>
<dd><p>defines how much information is printed during optimization.</p></dd>


<dt>rearrangements</dt>
<dd><p>SPR or NNI rearrangements.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to or from other methods (e.g.
model="sankoff" and cost matrix).</p></dd>


<dt>start</dt>
<dd><p>a starting tree can be supplied.</p></dd>


<dt>maxit</dt>
<dd><p>maximum number of iterations in the ratchet.</p></dd>


<dt>minit</dt>
<dd><p>minimum number of iterations in the ratchet.</p></dd>


<dt>k</dt>
<dd><p>number of rounds ratchet is stopped, when there is no improvement.</p></dd>


<dt>all</dt>
<dd><p>return all equally good trees or just one of them.</p></dd>


<dt>perturbation</dt>
<dd><p>whether to use "ratchet", "random_addition" or
"stochastic" (nni) for shuffling the tree.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>parsimony</code> returns the maximum parsimony score (pscore).
<code>optim.parsimony</code> returns a tree after NNI rearrangements.
<code>pratchet</code> returns a tree or list of trees containing the best tree(s)
found during the search.  <code>acctran</code> returns a tree with edge length
according to the ACCTRAN criterion.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The "SPR" rearrangements are so far only available for the "fitch" method,
"sankoff" only uses "NNI". The "fitch" algorithm only works correct for
binary trees.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Felsenstein, J. (2004). <em>Inferring Phylogenies</em>. Sinauer
Associates, Sunderland.</p>
<p>Nixon, K. (1999) The Parsimony Ratchet, a New Method for Rapid Parsimony
Analysis. <em>Cladistics</em> <b>15</b>, 407-414</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="bab.html">bab</a></code>, <code><a href="CI.html">CI</a></code>, <code><a href="CI.html">RI</a></code>, <code><a href="ancestral.pml.html">ancestral.pml</a></code>,
<code><a href="nni.html">nni</a></code>, <code><a href="NJ.html">NJ</a></code>, <code><a href="pml.html">pml</a></code>, <code><a href="getClans.html">getClans</a></code>
,<code><a href="ancestral.pml.html">ancestral.pars</a></code>, <code><a href="bootstrap.pml.html">bootstrap.pml</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="dist.hamming.html">dist.hamming</a></span><span class="op">(</span><span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="NJ.html">NJ</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">parsimony</span><span class="op">(</span><span class="va">tree</span>, <span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9796</span>
<span class="r-in"><span class="va">treeRA</span> <span class="op">&lt;-</span> <span class="fu">random.addition</span><span class="op">(</span><span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span class="r-in"><span class="va">treeNNI</span> <span class="op">&lt;-</span> <span class="fu">optim.parsimony</span><span class="op">(</span><span class="va">tree</span>, <span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Final p-score 9715 after  11 nni operations </span>
<span class="r-in"><span class="va">treeRatchet</span> <span class="op">&lt;-</span> <span class="fu">pratchet</span><span class="op">(</span><span class="va">Laurasiatherian</span>, start<span class="op">=</span><span class="va">tree</span>, maxit<span class="op">=</span><span class="fl">100</span>,</span>
<span class="r-in">                        minit<span class="op">=</span><span class="fl">5</span>, k<span class="op">=</span><span class="fl">5</span>, trace<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># assign edge length</span></span>
<span class="r-in"><span class="va">treeRatchet</span> <span class="op">&lt;-</span> <span class="fu">acctran</span><span class="op">(</span><span class="va">treeRatchet</span>, <span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="midpoint.html">midpoint</a></span><span class="op">(</span><span class="va">treeRatchet</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">add.scale.bar</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>, length<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span class="r-plt img"><img src="parsimony-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">parsimony</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tree</span>,<span class="va">treeNNI</span>, <span class="va">treeRatchet</span><span class="op">)</span>, <span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9796 9715 9713</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Klaus Schliep, Emmanuel Paradis, Leonardo de Oliveira Martins, Alastair Potts, Tim W. White.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer></div>

  

  

  </body></html>

