<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="pml computes the likelihood of a phylogenetic tree given a sequence
alignment and a model. optim.pml optimizes the different model
parameters."><title>Likelihood of a tree. — as.pml • phangorn</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Likelihood of a tree. — as.pml"><meta property="og:description" content="pml computes the likelihood of a phylogenetic tree given a sequence
alignment and a model. optim.pml optimizes the different model
parameters."><meta property="og:image" content="https://klausvigo.github.io/phangorn/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">phangorn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.10.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/AdvancedFeatures.html">Advanced features</a>
    <a class="dropdown-item" href="../articles/Ancestral.html">Ancestral Sequence Reconstruction</a>
    <a class="dropdown-item" href="../articles/IntertwiningTreesAndNetworks.html">Intertwining phylogenetic trees and networks: R Example Script</a>
    <a class="dropdown-item" href="../articles/Networx.html">Splits and Networx</a>
    <a class="dropdown-item" href="../articles/Trees.html">Estimating phylogenetic trees with phangorn</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/KlausVigo/phangorn/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Likelihood of a tree.</h1>
      <small class="dont-index">Source: <a href="https://github.com/KlausVigo/phangorn/blob/HEAD/R/modelTest.R" class="external-link"><code>R/modelTest.R</code></a>, <a href="https://github.com/KlausVigo/phangorn/blob/HEAD/R/phylo.R" class="external-link"><code>R/phylo.R</code></a></small>
      <div class="d-none name"><code>pml.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>pml</code> computes the likelihood of a phylogenetic tree given a sequence
alignment and a model. <code>optim.pml</code> optimizes the different model
parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">as.pml</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pml</span><span class="op">(</span><span class="va">tree</span>, <span class="va">data</span>, bf <span class="op">=</span> <span class="cn">NULL</span>, Q <span class="op">=</span> <span class="cn">NULL</span>, inv <span class="op">=</span> <span class="fl">0</span>, k <span class="op">=</span> <span class="fl">1</span>, shape <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  rate <span class="op">=</span> <span class="fl">1</span>, model <span class="op">=</span> <span class="cn">NULL</span>, site.rate <span class="op">=</span> <span class="st">"gamma"</span>, ASC <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">optim.pml</span><span class="op">(</span><span class="va">object</span>, optNni <span class="op">=</span> <span class="cn">FALSE</span>, optBf <span class="op">=</span> <span class="cn">FALSE</span>, optQ <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  optInv <span class="op">=</span> <span class="cn">FALSE</span>, optGamma <span class="op">=</span> <span class="cn">FALSE</span>, optEdge <span class="op">=</span> <span class="cn">TRUE</span>, optRate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  optRooted <span class="op">=</span> <span class="cn">FALSE</span>, control <span class="op">=</span> <span class="fu"><a href="pml.control.html">pml.control</a></span><span class="op">(</span><span class="op">)</span>, model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rearrangement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">optNni</span>, <span class="st">"NNI"</span>, <span class="st">"none"</span><span class="op">)</span>, subs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ratchet.par <span class="op">=</span> <span class="fu"><a href="pml.control.html">ratchet.control</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>So far only an object of class <code>modelTest</code>.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>


<dt>tree</dt>
<dd><p>A phylogenetic <code>tree</code>, object of class <code>phylo</code>.</p></dd>


<dt>data</dt>
<dd><p>An alignment, object of class <code>phyDat</code>.</p></dd>


<dt>bf</dt>
<dd><p>Base frequencies (see details).</p></dd>


<dt>Q</dt>
<dd><p>A vector containing the lower triangular part of the rate matrix.</p></dd>


<dt>inv</dt>
<dd><p>Proportion of invariable sites.</p></dd>


<dt>k</dt>
<dd><p>Number of intervals of the discrete gamma distribution.</p></dd>


<dt>shape</dt>
<dd><p>Shape parameter of the gamma distribution.</p></dd>


<dt>rate</dt>
<dd><p>Rate.</p></dd>


<dt>model</dt>
<dd><p>allows to choose an amino acid models or nucleotide model, see
details.</p></dd>


<dt>site.rate</dt>
<dd><p>Indicates what type of gamma distribution to use. Options
are "gamma" approach of Yang 1994 (default), "quadrature" after the Laguerre
quadrature approach of Felsenstein 2001 or "freerate".</p></dd>


<dt>ASC</dt>
<dd><p>ascertainment bias correction (ASC), allows to estimate models
like Lewis' Mkv.</p></dd>


<dt>object</dt>
<dd><p>An object of class <code>pml</code>.</p></dd>


<dt>optNni</dt>
<dd><p>Logical value indicating whether topology gets optimized (NNI).</p></dd>


<dt>optBf</dt>
<dd><p>Logical value indicating whether base frequencies gets
optimized.</p></dd>


<dt>optQ</dt>
<dd><p>Logical value indicating whether rate matrix gets optimized.</p></dd>


<dt>optInv</dt>
<dd><p>Logical value indicating whether proportion of variable size
gets optimized.</p></dd>


<dt>optGamma</dt>
<dd><p>Logical value indicating whether gamma rate parameter gets
optimized.</p></dd>


<dt>optEdge</dt>
<dd><p>Logical value indicating the edge lengths gets optimized.</p></dd>


<dt>optRate</dt>
<dd><p>Logical value indicating the overall rate gets optimized.</p></dd>


<dt>optRooted</dt>
<dd><p>Logical value indicating if the edge lengths of a rooted
tree get optimized.</p></dd>


<dt>control</dt>
<dd><p>A list of parameters for controlling the fitting process.</p></dd>


<dt>rearrangement</dt>
<dd><p>type of tree tree rearrangements to perform, one of
"none", "NNI", "stochastic" or "ratchet"</p></dd>


<dt>subs</dt>
<dd><p>A (integer) vector same length as Q to specify the optimization
of Q</p></dd>


<dt>ratchet.par</dt>
<dd><p>search parameter for stochastic search</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>pml</code> or <code>optim.pml</code> return a list of class <code>pml</code>,
some are useful for further computations like</p>
<dl><dt>tree</dt>
<dd><p>the phylogenetic
tree.</p></dd>
 <dt>data</dt>
<dd><p>the alignment.</p></dd>
 <dt>logLik</dt>
<dd><p>Log-likelihood of the
tree.</p></dd>
 <dt>siteLik</dt>
<dd><p>Site log-likelihoods.</p></dd>
 <dt>weight</dt>
<dd><p>Weight of the
site patterns.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Base frequencies in <code>pml</code> can be supplied in different ways.
For amino acid they are usually defined through specifying a model, so the
argument bf does not need to be specified. Otherwise if <code>bf=NULL</code>,
each state is given equal probability. It can be a numeric vector given the
frequencies. Last but not least <code>bf</code> can be string "equal", "empirical"
and for codon models additionally "F3x4".</p>
<p>The topology search uses a nearest neighbor interchange (NNI) and the
implementation is similar to phyML.  The option model in pml is only used
for amino acid models.  The option model defines the nucleotide model which
is getting optimized, all models which are included in modeltest can be
chosen. Setting this option (e.g. "K81" or "GTR") overrules options optBf
and optQ.  Here is a overview how to estimate different phylogenetic models
with <code>pml</code>:</p><table class="table table"><tr><td>model</td><td>optBf</td><td>optQ</td></tr><tr><td>Jukes-Cantor</td><td>FALSE</td><td>FALSE</td></tr><tr><td>F81</td><td>TRUE</td><td>FALSE</td></tr><tr><td>symmetric</td><td>FALSE</td><td>TRUE</td></tr><tr><td>GTR</td><td>TRUE</td><td>TRUE</td></tr></table><p>Via model in optim.pml the following
nucleotide models can be specified: JC, F81, K80, HKY, TrNe, TrN, TPM1, K81,
TPM1u, TPM2, TPM2u, TPM3, TPM3u, TIM1e, TIM1, TIM2e, TIM2, TIM3e, TIM3,
TVMe, TVM, SYM and GTR.  These models are specified as in Posada (2008).</p>
<p>So far 17 amino acid models are supported ("WAG", "JTT", "LG", "Dayhoff",
"cpREV", "mtmam", "mtArt", "MtZoa", "mtREV24", "VT","RtREV", "HIVw", "HIVb",
"FLU", "Blosum62", "Dayhoff_DCMut" and "JTT_DCMut") and additionally rate
matrices and amino acid frequencies can be supplied.</p>
<p>It is also possible to estimate codon models (e.g. YN98), for details see
also the chapter in vignette("phangorn-specials").</p>
<p>If the option 'optRooted' is set to TRUE than the edge lengths of rooted
tree are optimized. The tree has to be rooted and by now ultrametric!
Optimising rooted trees is generally much slower.</p>
<p>If <code>rearrangement</code> is set to <code>stochastic</code> a stochastic search
algorithm similar to Nguyen et al. (2015). and for <code>ratchet</code> the
likelihood ratchet as in Vos (2003).  This should helps often to find better
tree topologies, especially for larger trees.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Felsenstein, J. (1981) Evolutionary trees from DNA sequences: a
maximum likelihood approach. <em>Journal of Molecular Evolution</em>,
<b>17</b>, 368--376.</p>
<p>Felsenstein, J. (2004). <em>Inferring Phylogenies</em>. Sinauer Associates,
Sunderland.</p>
<p>Yang, Z. (2006). <em>Computational Molecular evolution</em>. Oxford University
Press, Oxford.</p>
<p>Adachi, J., P. J. Waddell, W. Martin, and M. Hasegawa (2000) Plastid genome
phylogeny and a model of amino acid substitution for proteins encoded by
chloroplast DNA.  <em>Journal of Molecular Evolution</em>, <b>50</b>, 348--358</p>
<p>Rota-Stabelli, O., Z. Yang, and M. Telford. (2009) MtZoa: a general
mitochondrial amino acid substitutions model for animal evolutionary
studies. <em>Mol. Phyl. Evol</em>, <b>52(1)</b>, 268--72</p>
<p>Whelan, S. and Goldman, N. (2001) A general empirical model of protein
evolution derived from multiple protein families using a maximum-likelihood
approach. <em>Molecular Biology and Evolution</em>, <b>18</b>, 691--699</p>
<p>Le, S.Q. and Gascuel, O. (2008) LG: An Improved, General Amino-Acid
Replacement Matrix <em>Molecular Biology and Evolution</em>, <b>25(7)</b>,
1307--1320</p>
<p>Yang, Z., R. Nielsen, and M. Hasegawa (1998) Models of amino acid
substitution and applications to Mitochondrial protein evolution.
<em>Molecular Biology and Evolution</em>, <b>15</b>, 1600--1611</p>
<p>Abascal, F., D. Posada, and R. Zardoya (2007) MtArt: A new Model of amino
acid replacement for Arthropoda. <em>Molecular Biology and Evolution</em>,
<b>24</b>, 1--5</p>
<p>Kosiol, C, and Goldman, N (2005) Different versions of the Dayhoff rate
matrix - <em>Molecular Biology and Evolution</em>, <b>22</b>, 193--199</p>
<p>L.-T. Nguyen, H.A. Schmidt, A. von Haeseler, and B.Q. Minh (2015) IQ-TREE: A
fast and effective stochastic algorithm for estimating maximum likelihood
phylogenies. <em>Molecular Biology and Evolution</em>, <b>32</b>, 268--274.</p>
<p>Vos, R. A. (2003) Accelerated Likelihood Surface Exploration: The Likelihood
Ratchet. <em>Systematic Biology</em>, <b>52(3)</b>, 368--373</p>
<p>Yang, Z., and R. Nielsen (1998) Synonymous and nonsynonymous rate variation
in nuclear genes of mammals. <em>Journal of Molecular Evolution</em>,
<b>46</b>, 409-418.</p>
<p>Lewis, P.O. (2001) A likelihood approach to estimating phylogeny from
discrete morphological character data. <em>Systematic Biology</em> <b>50</b>,
913--925.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="pml_bb.html">pml_bb</a></code>, <code><a href="bootstrap.pml.html">bootstrap.pml</a></code>,
<code><a href="modelTest.html">modelTest</a></code>, <code><a href="pmlPart.html">pmlPart</a></code>, <code><a href="pmlMix.html">pmlMix</a></code>,
<code>plot.phylo</code>, <code><a href="SH.test.html">SH.test</a></code>, <code><a href="ancestral.pml.html">ancestral.pml</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/example.html" class="external-link">example</a></span><span class="op">(</span><span class="va">NJ</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NJ&gt; data(Laurasiatherian)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NJ&gt; dm &lt;- dist.ml(Laurasiatherian)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NJ&gt; tree &lt;- NJ(dm)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NJ&gt; plot(tree)</span>
<span class="r-plt img"><img src="pml-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Jukes-Cantor (starting tree from NJ)</span></span></span>
<span class="r-in"><span>  <span class="va">fitJC</span> <span class="op">&lt;-</span> <span class="fu">pml</span><span class="op">(</span><span class="va">tree</span>, <span class="va">Laurasiatherian</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># optimize edge length parameter</span></span></span>
<span class="r-in"><span>  <span class="va">fitJC</span> <span class="op">&lt;-</span> <span class="fu">optim.pml</span><span class="op">(</span><span class="va">fitJC</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> optimize edge weights:  -54808.83 --&gt; -54230.41 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> optimize edge weights:  -54230.41 --&gt; -54230.41 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> optimize edge weights:  -54230.41 --&gt; -54230.41 </span>
<span class="r-in"><span>  <span class="va">fitJC</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model: JC </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> loglikelihood: -54230.41 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unconstrained loglikelihood: -17300.92 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rate matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   a c g t</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 0 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 1 0 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 1 1 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t 1 1 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Base frequencies:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    a    c    g    t </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.25 0.25 0.25 0.25 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># search for a better tree using NNI rearrangements</span></span></span>
<span class="r-in"><span>  <span class="va">fitJC</span> <span class="op">&lt;-</span> <span class="fu">optim.pml</span><span class="op">(</span><span class="va">fitJC</span>, optNni<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fitJC</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitJC</span><span class="op">$</span><span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># JC + Gamma + I - model</span></span></span>
<span class="r-in"><span>  <span class="va">fitJC_GI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fitJC</span>, k<span class="op">=</span><span class="fl">4</span>, inv<span class="op">=</span><span class="fl">.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># optimize shape parameter + proportion of invariant sites</span></span></span>
<span class="r-in"><span>  <span class="va">fitJC_GI</span> <span class="op">&lt;-</span> <span class="fu">optim.pml</span><span class="op">(</span><span class="va">fitJC_GI</span>, optGamma<span class="op">=</span><span class="cn">TRUE</span>, optInv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># GTR + Gamma + I - model</span></span></span>
<span class="r-in"><span>  <span class="va">fitGTR</span> <span class="op">&lt;-</span> <span class="fu">optim.pml</span><span class="op">(</span><span class="va">fitJC_GI</span>, rearrangement <span class="op">=</span> <span class="st">"stochastic"</span>,</span></span>
<span class="r-in"><span>      optGamma<span class="op">=</span><span class="cn">TRUE</span>, optInv<span class="op">=</span><span class="cn">TRUE</span>, model<span class="op">=</span><span class="st">"GTR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2-state data (RY-coded)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="as.phyDat.html">acgt2ry</a></span><span class="op">(</span><span class="va">Laurasiatherian</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fit2ST</span> <span class="op">&lt;-</span> <span class="fu">pml</span><span class="op">(</span><span class="va">tree</span>, <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">fit2ST</span> <span class="op">&lt;-</span> <span class="fu">optim.pml</span><span class="op">(</span><span class="va">fit2ST</span>,optNni<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> optimize edge weights:  -19996.09 --&gt; -17092.17 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> optimize edge weights:  -17092.17 --&gt; -17092.17 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  optimize topology:  -17092.17 --&gt; -17058.43 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NNI moves:  3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  optimize topology:  -17058.43 --&gt; -17030.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NNI moves:  3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  optimize topology:  -17030.4 --&gt; -17025.8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NNI moves:  3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  optimize topology:  -17025.8 --&gt; -17024.81 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NNI moves:  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  optimize topology:  -17024.81 --&gt; -17024.81 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NNI moves:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NNI moves:  10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> optimize edge weights:  -17024.81 --&gt; -17024.81 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  optimize topology:  -17024.81 --&gt; -17024.81 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NNI moves:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NNI moves:  0 </span>
<span class="r-in"><span>  <span class="va">fit2ST</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model: Mk </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> loglikelihood: -17024.81 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unconstrained loglikelihood: -8702.769 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rate matrix:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   r y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Base frequencies:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   r   y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5 0.5 </span>
<span class="r-in"><span><span class="co"># show some of the methods available for class pml</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"pml"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] AICc   BIC    anova  logLik plot   print  simSeq update vcov  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> see '?methods' for accessing help and source code</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Klaus Schliep, Emmanuel Paradis, Leonardo de Oliveira Martins, Alastair Potts, Tim W. White.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

