<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="plotBS plots a phylogenetic tree with the bootstrap values assigned
to the (internal) edges. It can also used to assign bootstrap values to a
phylogenetic tree. add_support adds support values to a plot."><title>Plotting trees with bootstrap values — plotBS • phangorn</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting trees with bootstrap values — plotBS"><meta property="og:description" content="plotBS plots a phylogenetic tree with the bootstrap values assigned
to the (internal) edges. It can also used to assign bootstrap values to a
phylogenetic tree. add_support adds support values to a plot."><meta property="og:image" content="https://klausvigo.github.io/phangorn/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">phangorn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.12.0.900</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Trees.html">Estimating phylogenetic trees with phangorn</a>
    <a class="dropdown-item" href="../articles/Morphological.html">Phylogenetic trees from morphological data</a>
    <a class="dropdown-item" href="../articles/AdvancedFeatures.html">Markov models and transition rate matrices</a>
    <a class="dropdown-item" href="../articles/Ancestral.html">Ancestral Sequence Reconstruction</a>
    <a class="dropdown-item" href="../articles/Networx.html">Splits and Networx</a>
    <a class="dropdown-item" href="../articles/MLbyHand.html">Maximum likelihood by hand</a>
    <a class="dropdown-item" href="../articles/IntertwiningTreesAndNetworks.html">Intertwining phylogenetic trees and networks: R Example Script</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/KlausVigo/phangorn/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plotting trees with bootstrap values</h1>
      <small class="dont-index">Source: <a href="https://github.com/KlausVigo/phangorn/blob/HEAD/R/plotBS.R" class="external-link"><code>R/plotBS.R</code></a></small>
      <div class="d-none name"><code>plotBS.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>plotBS</code> plots a phylogenetic tree with the bootstrap values assigned
to the (internal) edges. It can also used to assign bootstrap values to a
phylogenetic tree. <code>add_support</code> adds support values to a plot.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotBS</span><span class="op">(</span><span class="va">tree</span>, <span class="va">BStrees</span>, type <span class="op">=</span> <span class="st">"phylogram"</span>, method <span class="op">=</span> <span class="st">"FBP"</span>,</span>
<span>  bs.col <span class="op">=</span> <span class="st">"black"</span>, bs.adj <span class="op">=</span> <span class="cn">NULL</span>, digits <span class="op">=</span> <span class="fl">3</span>, p <span class="op">=</span> <span class="fl">0</span>, frame <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-06</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">add_support</span><span class="op">(</span><span class="va">tree</span>, <span class="va">trees</span>, method <span class="op">=</span> <span class="st">"FBP"</span>, tol <span class="op">=</span> <span class="fl">1e-08</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  frame <span class="op">=</span> <span class="st">"none"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tree</dt>
<dd><p>The tree on which edges the bootstrap values are plotted.</p></dd>


<dt>BStrees</dt>
<dd><p>a list of trees (object of class "multiPhylo").</p></dd>


<dt>type</dt>
<dd><p>the type of tree to plot, one of "phylogram", "cladogram", "fan",
"unrooted", "radial" or "none". If type is "none" the tree is returned with
the bootstrap values assigned to the node labels.</p></dd>


<dt>method</dt>
<dd><p>either "FBP" the classical bootstrap (default), "TBE"
(transfer bootstrap) or "MCC" for assigning clade credibilities. In case of
"MCC" all trees need to be rooted.</p></dd>


<dt>bs.col</dt>
<dd><p>color of bootstrap support labels.</p></dd>


<dt>bs.adj</dt>
<dd><p>one or two numeric values specifying the horizontal and
vertical justification of the bootstrap labels.</p></dd>


<dt>digits</dt>
<dd><p>integer indicating the number of decimal places.</p></dd>


<dt>p</dt>
<dd><p>only plot support values higher than this percentage number
(default is 0).</p></dd>


<dt>frame</dt>
<dd><p>a character string specifying the kind of frame to be printed
around the bootstrap values. This must be one of "none" (the default),
"rect" or "circle".</p></dd>


<dt>tol</dt>
<dd><p>a numeric value giving the tolerance to consider a branch length
significantly greater than zero.</p></dd>


<dt>...</dt>
<dd><p>further parameters used by <code>plot.phylo</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>plotBS</code> returns silently a tree, i.e. an object of class
<code>phylo</code> with the bootstrap values as node labels. The argument
<code>BStrees</code> is optional and if not supplied the labels supplied
in the <code>node.label</code> slot will be used.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The functions can either assign the classical Felsenstein’s bootstrap
proportions (FBP) (Felsenstein (1985), Hendy &amp; Penny (1985))  or the
transfer bootstrap expectation (TBE) of Lemoine et al. (2018). Using the
option <code>type=="n"</code> just assigns the bootstrap values and return the tree
without plotting it.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Felsenstein J. (1985) Confidence limits on phylogenies. An
approach using the bootstrap. <em>Evolution</em> <b>39</b>, 783--791</p>
<p>Lemoine, F., Entfellner, J. B. D., Wilkinson, E., Correia, D., Felipe, M. D.,
De Oliveira, T., &amp; Gascuel, O. (2018). Renewing Felsenstein’s phylogenetic
bootstrap in the era of big data. <em>Nature</em>, <b>556(7702)</b>, 452--456.</p>
<p>Penny D. and Hendy M.D. (1985) Testing methods evolutionary tree
construction. <em>Cladistics</em> <b>1</b>, 266--278</p>
<p>Penny D. and Hendy M.D. (1986) Estimating the reliability of evolutionary
trees. <em>Molecular Biology and Evolution</em> <b>3</b>, 403--417</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>plot.phylo</code>, <code><a href="add_ci.html">add_ci</a></code>,
<code>nodelabels</code>,
<code>prop.clades</code>, <code><a href="maxCladeCred.html">maxCladeCred</a></code>,
<code><a href="transferBootstrap.html">transferBootstrap</a></code>, <code><a href="https://rdrr.io/pkg/seqLogo/man/pwm-class.html" class="external-link">consensus</a></code>,
<code><a href="consensusNet.html">consensusNet</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/trees"</span>, package <span class="op">=</span> <span class="st">"phangorn"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># RAxML best-known tree with bipartition support (from previous analysis)</span></span></span>
<span class="r-in"><span><span class="va">raxml.tree</span> <span class="op">&lt;-</span> <span class="fu">read.tree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">fdir</span>,<span class="st">"RAxML_bipartitions.woodmouse"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># RAxML bootstrap trees (from previous analysis)</span></span></span>
<span class="r-in"><span><span class="va">raxml.bootstrap</span> <span class="op">&lt;-</span> <span class="fu">read.tree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">fdir</span>,<span class="st">"RAxML_bootstrap.woodmouse"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotBS</span><span class="op">(</span><span class="va">raxml.tree</span>,  <span class="va">raxml.bootstrap</span>, <span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotBS</span><span class="op">(</span><span class="va">raxml.tree</span>,  <span class="va">raxml.bootstrap</span>, <span class="st">"p"</span>, <span class="st">"TBE"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotBS-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Klaus Schliep, Emmanuel Paradis, Leonardo de Oliveira Martins, Alastair Potts, Iris Bardel-Kahr.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

