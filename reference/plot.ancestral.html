<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="plotAnc plots a phylogeny and adds character to the nodes. Either
takes output from  ancestral.pars or ancestral.pml or from an
alignment where there are node labels in the tree match the constructed
sequences in the alignment."><title>Plot ancestral character on a tree — plot.ancestral • phangorn</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot ancestral character on a tree — plot.ancestral"><meta property="og:description" content="plotAnc plots a phylogeny and adds character to the nodes. Either
takes output from  ancestral.pars or ancestral.pml or from an
alignment where there are node labels in the tree match the constructed
sequences in the alignment."><meta property="og:image" content="https://klausvigo.github.io/phangorn/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">phangorn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Trees.html">Estimating phylogenetic trees with phangorn</a>
    <a class="dropdown-item" href="../articles/Morphological.html">Phylogenetic trees from morphological data</a>
    <a class="dropdown-item" href="../articles/AdvancedFeatures.html">Markov models and transition rate matrices</a>
    <a class="dropdown-item" href="../articles/Ancestral.html">Ancestral Sequence Reconstruction</a>
    <a class="dropdown-item" href="../articles/Networx.html">Splits and Networx</a>
    <a class="dropdown-item" href="../articles/MLbyHand.html">Maximum likelihood by hand</a>
    <a class="dropdown-item" href="../articles/IntertwiningTreesAndNetworks.html">Intertwining phylogenetic trees and networks: R Example Script</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/KlausVigo/phangorn/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot ancestral character on a tree</h1>
      <small class="dont-index">Source: <a href="https://github.com/KlausVigo/phangorn/blob/HEAD/R/plotAnc.R" class="external-link"><code>R/plotAnc.R</code></a></small>
      <div class="d-none name"><code>plot.ancestral.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>plotAnc</code> plots a phylogeny and adds character to the nodes. Either
takes output from  <code>ancestral.pars</code> or <code>ancestral.pml</code> or from an
alignment where there are node labels in the tree match the constructed
sequences in the alignment.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for ancestral</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pie"</span>, <span class="st">"seqlogo"</span><span class="op">)</span>, site <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  node <span class="op">=</span> <span class="fu"><a href="midpoint.html">getRoot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">tree</span><span class="op">)</span>, col <span class="op">=</span> <span class="cn">NULL</span>, cex.pie <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  pos <span class="op">=</span> <span class="st">"bottomright"</span>, scheme <span class="op">=</span> <span class="cn">NULL</span>, start <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="fl">10</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plotAnc</span><span class="op">(</span><span class="va">x</span>, i <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="cn">NULL</span>, cex.pie <span class="op">=</span> <span class="fl">0.5</span>, pos <span class="op">=</span> <span class="st">"bottomright"</span>,</span>
<span>  scheme <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plotSeqLogo</span><span class="op">(</span><span class="va">x</span>, node <span class="op">=</span> <span class="fu"><a href="midpoint.html">getRoot</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">tree</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  scheme <span class="op">=</span> <span class="st">"Ape_NT"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>an object of class <code>ancestral</code>.</p></dd>


<dt>which</dt>
<dd><p>either "pie" or "seqlogo"</p></dd>


<dt>node</dt>
<dd><p>to plot for which the probabilities should be plotted.</p></dd>


<dt>col</dt>
<dd><p>a vector containing the colors for all possible states.</p></dd>


<dt>cex.pie</dt>
<dd><p>a numeric defining the size of the pie graphs.</p></dd>


<dt>pos</dt>
<dd><p>a character string defining the position of the legend.</p></dd>


<dt>scheme</dt>
<dd><p>a predefined color scheme. For amino acid options are "Ape_AA",
"Zappo_AA", "Clustal", "Polarity" and "Transmembrane_tendency", for
nucleotides "Ape_NT" and"RY_NT". Names can be abbreviated.</p></dd>


<dt>start</dt>
<dd><p>start position to plot.</p></dd>


<dt>end</dt>
<dd><p>end position to plot.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>


<dt>i, site</dt>
<dd><p>plots the i-th site.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For further details see vignette("Ancestral").</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ancestral.pml.html">ancestral.pml</a></code>, <code><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></code>,
<code><a href="https://rdrr.io/pkg/ape/man/image.DNAbin.html" class="external-link">image.DNAbin</a></code>, <code><a href="https://rdrr.io/pkg/ape/man/AAbin.html" class="external-link">image.AAbin</a></code>
<code><a href="https://rdrr.io/pkg/ggseqlogo/man/ggseqlogo.html" class="external-link">ggseqlogo</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/example.html" class="external-link">example</a></span><span class="op">(</span><span class="va">NJ</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NJ&gt; data(Laurasiatherian)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NJ&gt; dm &lt;- dist.ml(Laurasiatherian)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NJ&gt; tree &lt;- NJ(dm)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NJ&gt; plot(tree)</span>
<span class="r-plt img"><img src="plot.ancestral-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># generate node labels to ensure plotting will work</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">makeNodeLabel</span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">anc.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="ancestral.pml.html">ancestral.pars</a></span><span class="op">(</span><span class="va">tree</span>, <span class="va">Laurasiatherian</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># plot the third character</span></span></span>
<span class="r-in"><span><span class="fu">plotAnc</span><span class="op">(</span><span class="va">anc.p</span>, <span class="fl">3</span>, pos<span class="op">=</span><span class="st">"topright"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.ancestral-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plotSeqLogo</span><span class="op">(</span><span class="va">anc.p</span>, node<span class="op">=</span><span class="st">"Node10"</span>, <span class="fl">1</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for <span style="color: #00BB00;">x</span> is already present.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span>
<span class="r-plt img"><img src="plot.ancestral-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">chloroplast</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="parsimony.html">pratchet</a></span><span class="op">(</span><span class="va">chloroplast</span>,  maxit<span class="op">=</span><span class="fl">10</span>, trace<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">makeNodeLabel</span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">anc.ch</span> <span class="op">&lt;-</span> <span class="fu"><a href="ancestral.pml.html">ancestral.pars</a></span><span class="op">(</span><span class="va">tree</span>, <span class="va">chloroplast</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="fu"><a href="as.phyDat.html">as.phyDat</a></span><span class="op">(</span><span class="va">anc.ch</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.ancestral-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plotAnc</span><span class="op">(</span><span class="va">anc.ch</span>, <span class="fl">21</span>, scheme<span class="op">=</span><span class="st">"Ape_AA"</span>, pos<span class="op">=</span><span class="st">"topleft"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.ancestral-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plotAnc</span><span class="op">(</span><span class="va">anc.ch</span>, <span class="fl">21</span>, scheme<span class="op">=</span><span class="st">"Clustal"</span>, pos<span class="op">=</span><span class="st">"topleft"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.ancestral-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plotSeqLogo</span><span class="op">(</span><span class="va">anc.ch</span>, node<span class="op">=</span><span class="st">"Node1"</span>, <span class="fl">1</span>, <span class="fl">25</span>, scheme<span class="op">=</span><span class="st">"Clustal"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for <span style="color: #00BB00;">x</span> is already present.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span>
<span class="r-plt img"><img src="plot.ancestral-7.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klaus Schliep, Emmanuel Paradis, Leonardo de Oliveira Martins, Alastair Potts, Iris Bardel-Kahr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

